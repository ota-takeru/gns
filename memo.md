GNSを使った流体の再現について説明します。

GNSは物質の運動を予測する手法です。
物質を粒子の集まりとしてとらえ、粒子の状態を入力として次の時刻の粒子の状態をニューラルネットワークによって予測します。

ニューラルネットワークとは、与えらえた入力xに対して、正しい出力yをかえす関数を学習する手法です。
ニューラルネットワークの関数には重みと呼ばれる係数があります。
この図では入力x1からxmに対してwで表される重みをかけることでz1を計算しています。
これを繰り返すことで最終的なyの値を出力しています。
この最終的な出力yが正しい出力に近づくように何度も重みを更新することで学習を行います。

GNSの具体的な構造ついて説明します。
GNSでは、入力として粒子の位置や速度などを受け取り次の時刻の加速度を予測することで、次の時刻の粒子の位置や速度を計算します。
入力で受け取った粒子をノードとして扱い、半径R以内の近傍の粒子に対してエッジを張りグラフを作成します。
このノードやエッジには粒子の位置や速度などの情報が含まれています。
作成したグラフに対してメッセージパッシングを行い各粒子の次の時刻の加速度を予測します。
メッセージパッシングとはグラフに対して各ノードの近傍のノードから情報を集約し、ノードを更新することをいいます。
このメッセージパッシングを複数回繰り返すことで、粒子の位置や速度による相互作用を反映することができます。
この近傍のノードの情報を集約する関数がニューラルネットワークにおける重みをもちます。
右下の図では、ノードx1に対して、近傍のノードに重みwをかけて足すことで、ノードの値をz1に更新しています。
最後に、出力された加速度が正しい加速度に近づくようにこの重みを更新することで、学習を進めていきます。

---

実際にGNSを用いて流体を学習し再現してみます。
SPH法という流体の生成方法を用いて学習データを作成しました。
学習データは、粒子の状態が時間方向に並んだ時系列データです。今回は、1つのサンプルが200タイムステップからなるデータを用意しました。このデータには200個の時刻の状態が入っています。
また、学習データの数は100サンプル用意しました。1つのサンプルには流体のシミュレーションの最初の時刻から最後の時刻までの状態が入っており、各サンプルの初期条件を少し変えています。

結果は右の図のようになり、大きな挙動としてはあっていますが、右側の粒子の勢いが弱く壁に接触していないなど、正解の挙動と異なっている部分も多くあることが分かります。
さらに精度を上げるにどうすればいいのでしょうか？
今回は学習データに注目します。
学習データを異なる設定にすることで精度の違いにどのような傾向があるのかを調べます。

まずは学習データのタイムステップ数を変えて実験します。
100,200,400,800ステップで試しました。
結果は左下の図です。
横軸が時間変化で、縦軸が距離の誤差を表しています。
学習データの時間の長さを変えることで、一貫した誤差  の変化は見られませんでした。

次に学習データの数を50,100,200サンプルと変えて実験します。
結果は真ん中下の図です。
横軸が時間変化で、縦軸が距離の誤差を表しています。
データの数が100サンプルの時が多くの時間帯で一番誤差が小さくなるという結果になりました。

まとめ
学習データの長さは精度に大きく関係がなく、データの量を増やすことで精度が増えるわけではないことも分かった。
今回は、学習データの設定を変えて、学習の時間はすべて固定で行ったので、学習時間を変えることで精度がどのように変わるのか調べたいと思った。
