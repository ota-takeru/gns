# GNS モデル推論結果サマリー

## 実行日時

2025 年 10 月 22 日

## モデル情報

- 使用モデル: `models/model-100.pt` (latest)
- 学習ステップ: 100
- データセット: `datasets/out/test.npz` (valid.npz からコピー)

## 推論結果

### 全体統計

- 総 rollout 数: 3
- 平均 MSE: 311.42
- 平均距離誤差: 19.33

### 個別結果

#### rollout_ex0.pkl

- タイムステップ数: 234
- 粒子数: 64
- 次元: 2D
- MSE: 296.05
- 平均距離誤差: 18.87
- 可視化: `rollouts/rollout_ex0.html`

#### rollout_ex1.pkl

- タイムステップ数: 234
- 粒子数: 80
- 次元: 2D
- MSE: 290.21
- 平均距離誤差: 18.72
- 可視化: `rollouts/rollout_ex1.html`

#### rollout_ex2.pkl

- タイムステップ数: 234
- 粒子数: 80
- 次元: 2D
- MSE: 348.01
- 平均距離誤差: 20.41
- 可視化: `rollouts/rollout_ex2.html`

## 誤差の時間推移（rollout_ex0）

時間が経過するにつれて誤差が累積していく様子：

| ステップ | MSE      | 距離誤差 |
| -------- | -------- | -------- |
| 0        | 0.000    | 0.002    |
| 23       | 0.267    | 0.729    |
| 46       | 3.797    | 2.750    |
| 69       | 18.424   | 6.057    |
| 92       | 56.643   | 10.621   |
| 115      | 134.878  | 16.389   |
| 138      | 237.103  | 21.720   |
| 161      | 379.883  | 27.482   |
| 184      | 578.639  | 33.909   |
| 207      | 847.541  | 41.032   |
| 230      | 1201.237 | 48.841   |

## 考察

1. **学習進捗**: 100 ステップの学習では、基本的な物理現象を捉えているものの、長期的な予測精度には改善の余地があります。

2. **誤差の累積**: タイムステップが進むにつれて誤差が指数関数的に増加しています。これは、1 ステップごとの小さな誤差が累積していくためです。

3. **改善案**:
   - 学習ステップ数を増やす（現在 100 → 目標 20,000,000）
   - より多様なデータでの学習
   - ハイパーパラメータの調整

## 可視化の確認方法

生成された HTML ファイルをブラウザで開いて、予測結果と真値を比較できます：

```bash
# WSL2の場合
explorer.exe rollouts/rollout_ex0.html

# Linuxの場合
xdg-open rollouts/rollout_ex0.html
```

## 次のステップ

1. より長い学習を実行する
2. バリデーションロスを監視しながら学習する
3. 異なる物理シナリオでテストする

## 関連ファイル

- 推論設定: `config_rollout.yaml`
- 可視化スクリプト: `visualize_rollout.py`
- 分析スクリプト: `analyze_rollouts.py`
- 実行スクリプト: `run_inference.sh`
- 詳細ガイド: `INFERENCE_GUIDE.md`
