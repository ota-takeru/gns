自然界の基本法則はすべて局所性が成り立っている。
    もし成り立っていないと...
    遠くの事象が光速を超えて影響を及ぼし合うことになる。
    sphは局所性を前提としている。

摩擦・粘性は素のラグラジアンで書くことはできない
    ラグラジアンは以下を想定している。
    ・エネルギー保存
    ・体積が変化しない
    摩擦・粘性はこれらを満たさない。

L = T - V
    T: 運動エネルギー
    V: ポテンシャルエネルギー(熱力学)

熱力学
dU=δQ+δW: 内部エネルギーの変化＝熱＋仕事
    dU = TdS − PdV
    外力がする仕事 = PdV
    エントロピーの変化(dS) = δQ/T (δQは熱の出入り)


Lから運動方程式を導出する

sphとは
    連続体近似を前提とする。 -> 密度、速度、圧力が滑らかな場で定義される。
    ラグランジアンを離散で定義する。
    定義したラグランジアンから運動方程式を求める。
    力の対称性：エネルギーは位置の関数で表される。力はエネルギーから導かれるので位置に関して対称になる。
    エネルギー保存：エネルギーは密度に関する関数で表される。密度は全体で変わら
    ないのでエネルギーも保存される。

連続の式
$$
L = \int \left[ \rho v^2 - \rho u(\rho, s) \right] \, \mathrm{d}V,
$$

運動方程式を解くことは位置に対する関数x(t)を求めること

圧縮を許す流体では粒子同士が接近するので、人工粘性を加える必要がある。

アイデア
    gnsで加速度を出力するのではなくハミルトニアンを出力させる。
    H_TOTAL = H_SPH + ΔH_θ 
    ΔH_θ: H_SPHに加える補正項をニューラルで学習させる。精度を上げるための項。
    Hから加速度を出して学習データと比べる。
    H_TOTALは保存するようにする。
    H_TOTALにパラメータを含む散逸項を加えるのもあり。
    こうすることでエネルギー保存を満たしつつ摩擦・粘性を導入できる。
    近いものでNeuralSPHが比較対象になりそう。

    計算量は増えそう。
    一方で、低解像度で長いrolloutが可能になるかも。
    
    エネルギーの勾配から力が求まる。
    ハミルトニアンが位置と密度の関数になっている。
    各座標に対して偏微分することで力が求まる。


連続体モデルををどのように反映しているのか説明できるようにする。

Q
連続体において圧力pはどのように決めるのか？
sphにおいて同様にどうやって計算するのか？
sphにおいて質量の定義は？
音速cの意味は？
連続体の式の直感的な意味は？
sph法において粒子の密度の具体的な定義は、どの位置の話をしている？

A
連続体においてpは扱う物質によって異なる。

sphにおいて質量は一様に定められる。 
密度の定義はその地点の空間の密度を表す。

